<?xml version="1.0" encoding="UTF-8"?>
<fmiModelDescription
  fmiVersion="2.0"
  modelName="GT-DriveController"
  guid="{8c4e810f-3df3-4a00-8276-176fa3c9f000}"
  description="FMI 2.0 Co-Simulation Controller with Embedded Python and OSI Input"
  generationTool="GT-karny Hand-coded"
  variableNamingConvention="structured">

  <CoSimulation
    modelIdentifier="GT_DriveController"
    canHandleVariableCommunicationStepSize="true"
    canInterpolateInputs="false"
    maxOutputDerivativeOrder="0"
    canRunAsynchronuously="false"
    canBeInstantiatedOnlyOncePerProcess="false"
    canNotUseMemoryManagementFunctions="true"
    canGetAndSetFMUstate="false"
    canSerializeFMUstate="false"
    providesDirectionalDerivative="false">
  </CoSimulation>

  <LogCategories>
    <Category name="FMI" />
    <Category name="OSMP" />
    <Category name="OSI" />
  </LogCategories>

  <ModelVariables>
    <!-- OSI SensorView Pointer Inputs (Integers) -->
    <!-- Index 1: OSI_SensorView_In_BaseLo -->
    <ScalarVariable name="OSI_SensorView_In_BaseLo" valueReference="0" causality="input" variability="discrete">
      <Integer start="0" />
    </ScalarVariable>
    
    <!-- Index 2: OSI_SensorView_In_BaseHi -->
    <ScalarVariable name="OSI_SensorView_In_BaseHi" valueReference="1" causality="input" variability="discrete">
      <Integer start="0" />
    </ScalarVariable>
    
    <!-- Index 3: OSI_SensorView_In_Size -->
    <ScalarVariable name="OSI_SensorView_In_Size" valueReference="2" causality="input" variability="discrete">
      <Integer start="0" />
    </ScalarVariable>

    <!-- Control Outputs (Reals) -->
    <!-- VR 3: Throttle [0.0, 1.0] -->
    <ScalarVariable name="Throttle" valueReference="3" causality="output" variability="continuous">
      <Real start="0.0" />
    </ScalarVariable>

    <!-- VR 4: Brake [0.0, 1.0] -->
    <ScalarVariable name="Brake" valueReference="4" causality="output" variability="continuous">
      <Real start="0.0" />
    </ScalarVariable>

    <!-- VR 5: Steering [-1.0, 1.0] -->
    <ScalarVariable name="Steering" valueReference="5" causality="output" variability="continuous">
      <Real start="0.0" />
    </ScalarVariable>
    
    <!-- OSI SensorView Pointer Outputs (Integers) -->
    <!-- VR 7: OSI_SensorView_Out_BaseLo -->
    <ScalarVariable name="OSI_SensorView_Out_BaseLo" valueReference="7" causality="output" variability="discrete">
      <Integer />
    </ScalarVariable>
    
    <!-- VR 8: OSI_SensorView_Out_BaseHi -->
    <ScalarVariable name="OSI_SensorView_Out_BaseHi" valueReference="8" causality="output" variability="discrete">
      <Integer />
    </ScalarVariable>
    
    <!-- VR 9: OSI_SensorView_Out_Size -->
    <ScalarVariable name="OSI_SensorView_Out_Size" valueReference="9" causality="output" variability="discrete">
      <Integer />
    </ScalarVariable>

    <!-- VR 10: DriveMode (1:Forward, 0:Neutral, -1:Reverse) -->
    <ScalarVariable name="DriveMode" valueReference="10" causality="output" variability="discrete">
      <Integer />
    </ScalarVariable>

    <!-- Parameters (Strings) -->
    <!-- VR 11: PythonScriptPath -->
    <ScalarVariable name="PythonScriptPath" valueReference="11" causality="parameter" variability="fixed">
      <String start="logic.py" />
    </ScalarVariable>

    <!-- VR 12: PythonDependencyPath -->
    <ScalarVariable name="PythonDependencyPath" valueReference="12" causality="parameter" variability="fixed">
      <String start="" />
    </ScalarVariable>

    <!-- Validity Boolean (VR 6) -->
    <ScalarVariable name="valid" valueReference="6" causality="output" variability="discrete">
       <Boolean start="true" />
    </ScalarVariable>

  </ModelVariables>

  <ModelStructure>
    <Outputs>
      <Unknown index="4" /> <!-- Throttle -->
      <Unknown index="5" /> <!-- Brake -->
      <Unknown index="6" /> <!-- Steering -->
      <Unknown index="7" /> <!-- OSI_Out_BaseLo -->
      <Unknown index="8" /> <!-- OSI_Out_BaseHi -->
      <Unknown index="9" /> <!-- OSI_Out_Size -->
      <Unknown index="10" /> <!-- DriveMode -->
      <Unknown index="11" /> <!-- valid -->
    </Outputs>
  </ModelStructure>

</fmiModelDescription>
